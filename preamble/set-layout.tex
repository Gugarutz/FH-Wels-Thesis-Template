%===============================================================================%
%                                PAGE LAYOUT SETUP
%===============================================================================%
% This configures margins, headers/footers, spacing, etc.
% Based on KOMA-Script scrbook defaults, explicitly overridden as needed.

%-------------------------------------------------------------------------------%
%                                  KOMA OPTIONS
%-------------------------------------------------------------------------------%

    \usepackage{scrlayer-scrpage}

    \KOMAoptions{
        fontsize     = 12pt,     % Font size for base document
        sfdefaults   = false,    % Use serif font by default
        headsepline  = true,     % Horizontal line under header
        autooneside  = true,     % Auto-detect one-sided layout
        manualmark,              % Manual control over headers via \markleft etc.
    }

%-------------------------------------------------------------------------------%
%                               HEADERS & FOOTERS
%-------------------------------------------------------------------------------%

    % Show chapter title in header (exclude number for unnumbered \addchap)
    \renewcommand{\chaptermark}[1]{%
      \markleft{\ifnum\value{chapter}=0 #1\else\thechapter~#1\fi}%
    }

    % Show section title in header (exclude number for unnumbered \addsec)
    \renewcommand{\sectionmark}[1]{%
      \markright{\ifnum\value{section}=0 #1\else\thesection~#1\fi}%
    }

    \clearpairofpagestyles           % Clear all KOMA defaults

    \ihead[\empty]{\leftmark}        % Chapter title (left-aligned)
    \ohead[\empty]{\rightmark}       % Section title (right-aligned)
    \ofoot[\pagemark]{\pagemark}     % Page number (right-aligned in footer)

%-------------------------------------------------------------------------------%
%                                    MARGINS
%-------------------------------------------------------------------------------%

    \usepackage{geometry}
        \geometry{
            a4paper,
            left  =3.5cm,     % Important: binding edge
            right =2.0cm,
            top   =2.5cm,
            bottom=2.0cm
        }

%-------------------------------------------------------------------------------%
%                            HEADER/FOOTER BOX SIZES
%-------------------------------------------------------------------------------%
    % Dynamically use \baselinestretch to match line spacing

    \setlength{\footskip}    {\baselinestretch\baselineskip}
    \setlength{\footheight}  {20pt}
    \setlength{\headsep}     {\baselinestretch\baselineskip}
    \setlength{\headheight}  {20pt}

%-------------------------------------------------------------------------------%
%                                 OTHER PACKAGES
%-------------------------------------------------------------------------------%

    \usepackage[absolute]{textpos}  % Used for declaration blocks, absolute text positioning