%===============================================================================%
%                                MATH CONFIGURATION                             %
%===============================================================================%
% This configures mathematical environments, fonts, symbols, and unit handling.
% See also ./preamble/mod-math.tex for custom math commands and adjustments

%-------------------------------------------------------------------------------%
%                             MATH ENVIRONMENTS                                 %
%-------------------------------------------------------------------------------%

    \usepackage{mathtools}    % Extension of amsmath, fixes some bugs
    \usepackage{amssymb}      % Extra symbols from American Mathematical Society
    \usepackage{thmtools}     % Enhances theorem environments (loads amsthm)

%-------------------------------------------------------------------------------%
%                            MATH SYMBOLS & SPACING                             %
%-------------------------------------------------------------------------------%

    \usepackage{icomma}       % Prevents extra space after comma in decimals

%-------------------------------------------------------------------------------%
%                                MATH FONTS                                     %
%-------------------------------------------------------------------------------%

    \usepackage{dsfont}       % Blackboard bold (\mathds)
    \usepackage{newtxmath}    % Nicer math fonts, supports \mathscr

%-------------------------------------------------------------------------------%
%                       SIUNITX AND PHYSICS PACKAGE PATCHES                     %
%-------------------------------------------------------------------------------%

    \usepackage{physics}      % Physics-style commands (e.g., \dv, \eval, etc.)
    \NewCommandCopy\set\qty   % Save \qty from physics as \set

    \usepackage{siunitx}      % For \SI and \qty commands (units and values)

    % Restore preferred definitions after package loading
    \AtBeginDocument{%
        \RenewCommandCopy\set\qty   % Redefine \set from physics version
        \RenewCommandCopy\qty\SI    % Redefine \qty to use \SI
    }

    % Silence siunitx/physics command redefinition warning
    \ExplSyntaxOn
        \msg_redirect_name:nnn { siunitx } { physics-pkg } { none }
    \ExplSyntaxOff
